class ExploitsController < ApplicationController
  def pick
    begin
      @exploit = EvasionDB::AttackModule.find(params[:id])
    rescue
      # rescue if no exploit found
      @exploit = nil
    end
    if @exploit
      exploit_options = render_to_string :partial=>"exploits/exploit_options", :locals=>{:exploit=>@exploit}
      idmef_events = render_to_string :partial=>"idmef_events/idmef_events", :locals=>{:idmef_events=>@exploit.idmef_events}

      render :update do |page|
        page <<%{
          $("#exploit_description").html("hier fehlt noch die beschreibung aus msf");
          $("#exploit_options").html("#{escape_javascript(exploit_options)}");
          $("#idmef_events").html("#{escape_javascript(idmef_events)}");
          $("#exploit_name").html("#{@exploit.name}");
        }
      end
    else
      render :update do |page|
        page << %{
          alert("No Exploit found. Check your EvasionDB.")
        }
      end
    end
  end

end
